<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Đăng nhập — ePortfolio</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --green-1:#0f5132;
  --green-2:#198754;
  --green-3:#66bb6a;
  --bg-gradient:linear-gradient(135deg,#d7ffe5,#a8efb5);
  --card-shadow:0 12px 26px rgba(17,50,30,0.14);
}

*{box-sizing:border-box;margin:0;padding:0;font-family:'Inter',sans-serif;}
body{height:100vh;display:flex;justify-content:center;align-items:center;background:var(--bg-gradient);transition:background 0.5s;}
.login-card{
  background:white;
  border-radius:22px;
  padding:36px 28px;
  width:360px;
  max-width:90%;
  box-shadow:var(--card-shadow);
  text-align:center;
  position:relative;
  overflow:hidden;
  animation:fadeIn 1s ease;
  transition:transform 0.3s;
}
@keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
@keyframes shake{
  0%,100%{transform:translateX(0);}
  20%,60%{transform:translateX(-10px);}
  40%,80%{transform:translateX(10px);}
}
.login-card.shake{animation:shake 0.4s;}

.avatar{
  width:80px;height:80px;
  background:linear-gradient(135deg,var(--green-2),var(--green-3));
  border-radius:50%;
  display:flex;
  justify-content:center;
  align-items:center;
  color:white;
  font-size:28px;
  font-weight:700;
  margin:0 auto 20px auto;
  box-shadow:0 8px 20px rgba(17,50,30,0.12);
  transition:transform 0.4s ease;
}
.avatar:hover{transform:rotate(5deg) scale(1.05);}

.login-card h2{color:var(--green-1);margin-bottom:24px;font-weight:700;}
.input-group{margin-bottom:18px;position:relative;}
.input-group input{
  width:100%;
  padding:14px 16px;
  border-radius:12px;
  border:1px solid #e6f2ea;
  font-size:15px;
  outline:none;
  transition:0.3s;
}
.input-group input:focus{
  border:2px solid var(--green-2);
  box-shadow:0 4px 12px rgba(25,135,84,0.2);
}

.login-btn{
  width:100%;
  padding:14px;
  border:none;
  border-radius:12px;
  font-weight:700;
  color:white;
  background:linear-gradient(90deg,var(--green-2),var(--green-3));
  font-size:16px;
  cursor:pointer;
  transition:0.3s;
  margin-top:8px;
}
.login-btn:hover{
  transform:scale(1.05);
  box-shadow:0 8px 20px rgba(25,135,84,0.35);
}

.info{
  text-align:center;
  margin-top:14px;
  font-size:13px;
  color:#3b4f44;
}

/* Responsive nhỏ hơn 400px */
@media(max-width:400px){
  .login-card{padding:28px 20px;}
  .avatar{width:60px;height:60px;font-size:24px;}
}
</style>
</head>
<body>
<div class="login-card" id="login-card">
  <div class="avatar">ND</div>
  <h2>Đăng nhập ePortfolio</h2>
  <form id="login-form">
    <div class="input-group">
      <input type="text" id="username" placeholder="Tên đăng nhập" required>
    </div>
    <div class="input-group">
      <input type="password" id="password" placeholder="Mật khẩu" required>
    </div>
    <button type="submit" class="login-btn">Đăng nhập</button>
  </form>
  <p class="info">Tên demo: <strong>admin/12345</strong> hoặc <strong>user/54321</strong></p>
</div>

<script>
    // Khi mở trang login, reset trạng thái đăng nhập
localStorage.removeItem('loggedIn');
localStorage.removeItem('currentUser');

const loginForm = document.getElementById('login-form');
const loginCard = document.getElementById('login-card');

loginForm.addEventListener('submit', async e=>{
  e.preventDefault();
  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value.trim();

  try{
    const res = await fetch('/api/auth/login', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({username,password})
    });
    const data = await res.json();
    if(res.ok){
      localStorage.setItem('loggedIn','true');
      localStorage.setItem('currentUser',data.username);
      window.location.href='index.html';
    } else {
      loginCard.classList.add('shake');
      setTimeout(()=>loginCard.classList.remove('shake'),400);
      alert(data.message);
    }
  }catch(err){
    alert('Lỗi kết nối server!');
  }
});

// Nếu đã login, tự động chuyển sang index.html
if(localStorage.getItem('loggedIn')==='true'){
  window.location.href='index.html';
}
</script>
</body>
</html>
